<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Conditional Rendering Debug</title>
		<style>
			body {
				font-family: sans-serif;
				margin: 2rem;
			}
			.debug {
				background: #f0f0f0;
				padding: 1rem;
				margin: 1rem 0;
			}
			button {
				padding: 0.5rem 1rem;
				margin: 0.5rem;
			}
		</style>
	</head>
	<body>
		<h1>Conditional Rendering Debug</h1>

		<button onclick="window.toggleCondition()">Toggle Condition</button>
		<button onclick="window.debugStates()">Debug States</button>

		<div class="debug">
			<div>
				Condition Value: <span id="condition-display">false</span>
			</div>
		</div>

		<!-- Simple conditional test -->
		<div
			data-if="testCondition.value"
			style="background: lightgreen; padding: 1rem; margin: 1rem 0"
		>
			✅ Condition is TRUE
		</div>

		<div
			data-else
			style="background: lightcoral; padding: 1rem; margin: 1rem 0"
		>
			❌ Condition is FALSE (data-else)
		</div>

		<script type="module">
			import { State } from "./src/index.js";
			import { attributeParser } from "./src/attribute-parser.js";

			// Create a simple boolean state
			const testCondition = new State(false);

			// Expose globally
			window.testCondition = testCondition;

			// Update display when condition changes
			testCondition.effect(() => {
				const display = document.getElementById("condition-display");
				if (display) {
					display.textContent = testCondition.value.toString();
				}
				console.log("Condition changed to:", testCondition.value);
			});

			// Global functions
			window.toggleCondition = () => {
				testCondition.value = !testCondition.value;
			};

			window.debugStates = () => {
				console.log("=== DEBUG INFO ===");
				console.log("testCondition.value:", testCondition.value);

				// Check registered elements
				const ifElement = document.querySelector("[data-if]");
				const elseElement = document.querySelector("[data-else]");

				console.log("If element:", ifElement);
				console.log("Else element:", elseElement);

				if (ifElement) {
					console.log("If element display:", ifElement.style.display);
				}
				if (elseElement) {
					console.log(
						"Else element display:",
						elseElement.style.display
					);
				}
			};

			// Parse DOM after everything is loaded
			document.addEventListener("DOMContentLoaded", () => {
				console.log("Parsing DOM...");
				attributeParser.parseContainer(document.body);
				console.log("DOM parsing complete");

				// Debug initial state
				setTimeout(() => {
					window.debugStates();
				}, 100);
			});
		</script>
	</body>
</html>
