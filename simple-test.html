<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Simple Data Bind Test</title>
	</head>
	<body>
		<h1>Simple Data Binding Test</h1>

		<p>Count: <span data-bind="textContent: count.value">0</span></p>
		<p>Count x2: <span data-bind="textContent: count.value * 2">0</span></p>

		<button onclick="incrementCount()">+</button>
		<button onclick="decrementCount()">-</button>

		<script type="module">
			import { State } from "./src/index.js";
			import { attributeParser } from "./src/attribute-parser.js";

			console.log("üöÄ Starting simple test...");

			// Create state
			const count = new State(5); // Start with 5 to see if it shows up

			// Set up effect to monitor count changes
			count.effect(() => {
				console.log("üìä Count changed to:", count.value);
			});

			// Expose to global scope
			window.count = count;
			console.log("üåê Exposed count to global:", window.count);

			// Test functions
			window.incrementCount = () => {
				console.log("‚ûï Incrementing count from", count.value);
				count.value += 1;
			};

			window.decrementCount = () => {
				console.log("‚ûñ Decrementing count from", count.value);
				count.value -= 1;
			};

			// Parse DOM when ready
			document.addEventListener("DOMContentLoaded", () => {
				console.log("üìÑ DOM ready, parsing attributes...");

				// Check if global variables are accessible
				console.log("üîç Global count:", window.count);
				console.log("üîç Count value:", window.count?.value);

				attributeParser.parseContainer(document.body);

				console.log("‚úÖ Parsing complete");

				// Test automatic update after 3 seconds
				setTimeout(() => {
					console.log("‚è∞ Auto-updating count to 99");
					count.value = 99;
				}, 3000);
			});
		</script>
	</body>
</html>
